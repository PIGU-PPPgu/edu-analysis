# æ™ºèƒ½å­—æ®µè¯¢é—®åŠŸèƒ½è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

å½“æ™ºèƒ½è§£æå™¨é‡åˆ°æ— æ³•è¯†åˆ«çš„å­—æ®µæ—¶ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºä¸€ä¸ªç®€æ´çš„"å­—æ®µè¯¢é—®"å¯¹è¯æ¡†ï¼Œè®©ç”¨æˆ·æè¿°è¿™äº›å­—æ®µçš„ç”¨é€”ï¼Œç„¶åé€šè¿‡AIæ¥æ™ºèƒ½åˆ¤å®šå­—æ®µç±»å‹ã€‚è¿™æ ·æ—¢ä¿æŒäº†è‡ªåŠ¨åŒ–ï¼Œåˆèƒ½å¤„ç†è¾¹ç¼˜æƒ…å†µã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½å­—æ®µè¯†åˆ«
- è‡ªåŠ¨è¯†åˆ«å¸¸è§çš„å­¦ç”Ÿä¿¡æ¯å­—æ®µï¼ˆå§“åã€å­¦å·ã€ç­çº§ç­‰ï¼‰
- è‡ªåŠ¨è¯†åˆ«å„ç§‘ç›®çš„åˆ†æ•°ã€ç­‰çº§ã€æ’åå­—æ®µ
- æ”¯æŒå¤šç§å‘½åæ ¼å¼å’Œè¡¨å¤´ç»“æ„

### 2. æœªçŸ¥å­—æ®µå¤„ç†
- å½“é‡åˆ°æ— æ³•è¯†åˆ«çš„å­—æ®µæ—¶ï¼Œæ”¶é›†æ ·æœ¬æ•°æ®
- æ˜¾ç¤ºç®€æ´çš„è¯¢é—®ç•Œé¢ï¼Œåªè¯¢é—®æœªè¯†åˆ«çš„å­—æ®µ
- é¿å…å¤æ‚çš„å­—æ®µæ˜ å°„ç•Œé¢

### 3. AIæ™ºèƒ½åˆ¤å®š
- æ ¹æ®å­—æ®µåç§°å’Œç”¨æˆ·æè¿°ï¼Œä½¿ç”¨AIåˆ†æå­—æ®µç±»å‹
- æ”¯æŒå¤šç§åˆ¤å®šç­–ç•¥ï¼šè§„åˆ™åŒ¹é… + AIæ¨ç†
- è¿”å›ç½®ä¿¡åº¦å’Œå»ºè®®çš„å­—æ®µç±»å‹

### 4. å­¦ä¹ æœºåˆ¶
- è®°å½•ç”¨æˆ·çš„å­—æ®µæè¿°å’Œæœ€ç»ˆé€‰æ‹©
- ç”¨äºæ”¹è¿›æœªæ¥çš„å­—æ®µè¯†åˆ«ç®—æ³•

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒç»„ä»¶

1. **aiFieldClassifier.ts** - AIå­—æ®µåˆ†ç±»æœåŠ¡
   - æä¾›å­—æ®µç±»å‹åˆ¤å®šåŠŸèƒ½
   - æ”¯æŒå¤šç§AIæ¨¡å‹
   - è¿”å›ç½®ä¿¡åº¦å’Œæ¨ç†è¿‡ç¨‹

2. **FieldInquiryDialog.tsx** - å­—æ®µè¯¢é—®å¯¹è¯æ¡†
   - æ˜¾ç¤ºæœªè¯†åˆ«å­—æ®µåˆ—è¡¨
   - æä¾›æè¿°è¾“å…¥å’Œå¿«é€Ÿé€‰æ‹©
   - å®æ—¶AIå»ºè®®æ˜¾ç¤º

3. **intelligentFileParser.ts** - æ™ºèƒ½æ–‡ä»¶è§£æå™¨
   - è¯†åˆ«å·²çŸ¥å­—æ®µç±»å‹
   - æ ‡è®°æœªçŸ¥å­—æ®µ
   - è¿”å›è§£æç»“æœå’ŒæœªçŸ¥å­—æ®µä¿¡æ¯

### æ•°æ®æµç¨‹

```
æ–‡ä»¶ä¸Šä¼  â†’ æ™ºèƒ½è§£æ â†’ æ£€æŸ¥æœªçŸ¥å­—æ®µ â†’ å­—æ®µè¯¢é—®ï¼ˆå¦‚éœ€è¦ï¼‰â†’ AIåˆ¤å®š â†’ æœ€ç»ˆå¯¼å…¥
```

## ğŸ“‹ ä½¿ç”¨æµç¨‹

### 1. æ­£å¸¸æƒ…å†µï¼ˆæ— æœªçŸ¥å­—æ®µï¼‰
1. ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
2. æ™ºèƒ½è§£æå™¨è¯†åˆ«æ‰€æœ‰å­—æ®µ
3. ç½®ä¿¡åº¦ â‰¥ 0.8ï¼Œè‡ªåŠ¨è·³è¿‡å­—æ®µæ˜ å°„
4. ç›´æ¥è¿›å…¥å¯¼å…¥æµç¨‹

### 2. æœ‰æœªçŸ¥å­—æ®µçš„æƒ…å†µ
1. ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
2. æ™ºèƒ½è§£æå™¨è¯†åˆ«å¤§éƒ¨åˆ†å­—æ®µï¼Œå‘ç°æœªçŸ¥å­—æ®µ
3. æ˜¾ç¤ºå­—æ®µè¯¢é—®å¯¹è¯æ¡†
4. ç”¨æˆ·ä¸ºæœªçŸ¥å­—æ®µæä¾›æè¿°
5. AIæ™ºèƒ½åˆ¤å®šå­—æ®µç±»å‹
6. åˆå¹¶æ˜ å°„ç»“æœï¼Œç»§ç»­å¯¼å…¥æµç¨‹

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•æ–‡ä»¶ï¼štest-unknown-fields.csv
åŒ…å«86ä¸ªå­—æ®µï¼Œå…¶ä¸­ï¼š
- **å·²çŸ¥å­—æ®µ**ï¼šå§“åã€ç­çº§ã€å„ç§‘ç›®åˆ†æ•°/ç­‰çº§/æ’å
- **æœªçŸ¥å­—æ®µ**ï¼šç¥ç§˜å­—æ®µ1ã€ç¥ç§˜å­—æ®µ2ã€æœªçŸ¥è¯„åˆ†ã€ç‰¹æ®Šæ ‡è®°

### æµ‹è¯•æ­¥éª¤
1. ä¸Šä¼ æµ‹è¯•æ–‡ä»¶
2. è§‚å¯Ÿæ™ºèƒ½è§£æç»“æœ
3. æ£€æŸ¥æ˜¯å¦è§¦å‘å­—æ®µè¯¢é—®
4. ä¸ºæœªçŸ¥å­—æ®µæä¾›æè¿°
5. éªŒè¯AIåˆ¤å®šç»“æœ

### é¢„æœŸç»“æœ
- 82ä¸ªå­—æ®µè‡ªåŠ¨è¯†åˆ«ï¼ˆ95%è¯†åˆ«ç‡ï¼‰
- 4ä¸ªæœªçŸ¥å­—æ®µè§¦å‘è¯¢é—®
- ç”¨æˆ·æè¿°åAIæ­£ç¡®åˆ¤å®š
- æœ€ç»ˆå®ç°å®Œå…¨è‡ªåŠ¨åŒ–å¯¼å…¥

## ğŸ’¡ ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### ç®€åŒ–çš„è¯¢é—®ç•Œé¢
- åªæ˜¾ç¤ºæœªè¯†åˆ«çš„å­—æ®µ
- æä¾›å¸¸è§ç±»å‹çš„å¿«é€Ÿé€‰æ‹©æŒ‰é’®
- å®æ—¶æ˜¾ç¤ºAIå»ºè®®
- æ”¯æŒæ‰¹é‡ç¡®è®¤

### æ™ºèƒ½æç¤º
- æ ¹æ®å­—æ®µåç§°æä¾›åˆå§‹å»ºè®®
- æ˜¾ç¤ºæ ·æœ¬æ•°æ®å¸®åŠ©ç”¨æˆ·ç†è§£
- æä¾›ç½®ä¿¡åº¦æŒ‡ç¤º
- æ”¯æŒæ’¤é”€å’Œé‡æ–°é€‰æ‹©

### å­¦ä¹ èƒ½åŠ›
- è®°ä½ç”¨æˆ·çš„é€‰æ‹©åå¥½
- æ”¹è¿›æœªæ¥çš„å­—æ®µè¯†åˆ«
- æ”¯æŒè‡ªå®šä¹‰å­—æ®µç±»å‹
- æä¾›å†å²æ˜ å°„è§„åˆ™

## ğŸ”® æœªæ¥æ‰©å±•

### 1. æ›´å¼ºçš„AIèƒ½åŠ›
- æ”¯æŒæ›´å¤šAIæ¨¡å‹
- å¤šæ¨¡å‹æŠ•ç¥¨æœºåˆ¶
- ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›
- é¢†åŸŸä¸“ä¸šçŸ¥è¯†

### 2. æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
- æ‹–æ‹½å¼å­—æ®µæ˜ å°„
- å¯è§†åŒ–å­—æ®µå…³ç³»
- æ‰¹é‡æ“ä½œæ”¯æŒ
- æ¨¡æ¿ä¿å­˜åŠŸèƒ½

### 3. ä¼ä¸šçº§åŠŸèƒ½
- å›¢é˜Ÿå…±äº«æ˜ å°„è§„åˆ™
- å®¡æ‰¹æµç¨‹é›†æˆ
- æ•°æ®è´¨é‡æ£€æŸ¥
- åˆè§„æ€§éªŒè¯

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### è¯†åˆ«å‡†ç¡®ç‡
- å¸¸è§å­—æ®µï¼š>95%
- ç§‘ç›®å­—æ®µï¼š>90%
- æ’åå­—æ®µï¼š>85%
- è‡ªå®šä¹‰å­—æ®µï¼šé€šè¿‡AIåˆ¤å®š

### ç”¨æˆ·ä½“éªŒ
- å‡å°‘æ‰‹åŠ¨æ˜ å°„å·¥ä½œé‡ï¼š80%+
- å¯¼å…¥æµç¨‹æ—¶é—´ï¼šå‡å°‘60%+
- ç”¨æˆ·æ»¡æ„åº¦ï¼šæ˜¾è‘—æå‡
- é”™è¯¯ç‡ï¼šå¤§å¹…é™ä½

---

è¿™ä¸ªåŠŸèƒ½å°†å¤§å¤§æå‡ç”¨æˆ·çš„æ•°æ®å¯¼å…¥ä½“éªŒï¼Œè®©ç³»ç»Ÿæ›´åŠ æ™ºèƒ½å’Œæ˜“ç”¨ï¼

# æ™ºèƒ½å­—æ®µè¯¢é—®åŠŸèƒ½ - å‰ç«¯é›†æˆæ–¹æ¡ˆ

## é—®é¢˜åˆ†æ

å½“å‰AIå­—æ®µåˆ†æåŠŸèƒ½æ²¡æœ‰èµ·ä½œç”¨çš„åŸå› ï¼š
1. âŒ AI Edge Functionæœªéƒ¨ç½²åˆ°Supabaseäº‘ç«¯
2. âŒ å‰ç«¯è°ƒç”¨æ—¶è¿”å›404é”™è¯¯
3. âŒ ç³»ç»Ÿé™çº§åˆ°åŸºç¡€ç®—æ³•ï¼Œå¤±å»AIæ™ºèƒ½æ€§

## è§£å†³æ–¹æ¡ˆï¼šå‰ç«¯ç›´æ¥é›†æˆAI

### 1. åˆ›å»ºå‰ç«¯AIå­—æ®µåˆ†ææœåŠ¡

```typescript
// src/services/aiFieldAnalyzer.ts
import { getUserAIConfig } from '@/services/aiConfigService';

export interface FieldMapping {
  originalField: string;
  mappedField: string;
  subject?: string;
  dataType: 'score' | 'grade' | 'rank' | 'student_info';
  confidence: number;
  notes?: string;
}

export interface AIAnalysisResult {
  mappings: FieldMapping[];
  subjects: string[];
  tableStructure: {
    type: 'wide' | 'long' | 'mixed';
    hasMergedCells: boolean;
    hasMultiLevelHeaders: boolean;
  };
  examInfo: {
    title?: string;
    type?: string;
    date?: string;
  };
  dataQuality: {
    missingFields: string[];
    inconsistentFormats: string[];
    suspiciousData: string[];
  };
  confidence: number;
  reasoning: string;
}

export class AIFieldAnalyzer {
  private async callAI(prompt: string): Promise<string> {
    const aiConfig = await getUserAIConfig();
    
    if (!aiConfig) {
      throw new Error('è¯·å…ˆé…ç½®AIæœåŠ¡');
    }

    let apiUrl: string;
    let headers: Record<string, string>;
    let body: any;

    switch (aiConfig.provider) {
      case 'openai':
        apiUrl = 'https://api.openai.com/v1/chat/completions';
        headers = {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${aiConfig.apiKey}`
        };
        body = {
          model: 'gpt-3.5-turbo',
          messages: [
            {
              role: 'system',
              content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²æ•°æ®è§£æä¸“å®¶ï¼Œæ“…é•¿åˆ†æå­¦ç”Ÿæˆç»©æ•°æ®çš„å­—æ®µç»“æ„ã€‚'
            },
            {
              role: 'user',
              content: prompt
            }
          ],
          temperature: 0.1,
          max_tokens: 3000
        };
        break;

      case 'doubao':
        apiUrl = 'https://ark.cn-beijing.volces.com/api/v3/chat/completions';
        headers = {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${aiConfig.apiKey}`
        };
        body = {
          model: 'ep-20241213150608-8rvtx',
          messages: [
            {
              role: 'system', 
              content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²æ•°æ®è§£æä¸“å®¶ï¼Œæ“…é•¿åˆ†æå­¦ç”Ÿæˆç»©æ•°æ®çš„å­—æ®µç»“æ„ã€‚'
            },
            {
              role: 'user',
              content: prompt
            }
          ],
          temperature: 0.1,
          max_tokens: 3000
        };
        break;

      default:
        throw new Error(`ä¸æ”¯æŒçš„AIæä¾›å•†: ${aiConfig.provider}`);
    }

    const response = await fetch(apiUrl, {
      method: 'POST',
      headers,
      body: JSON.stringify(body)
    });

    if (!response.ok) {
      throw new Error(`AI APIè°ƒç”¨å¤±è´¥: ${response.status}`);
    }

    const result = await response.json();
    return result.choices?.[0]?.message?.content || '';
  }

  async analyzeFields(headers: string[], sampleData: any[]): Promise<AIAnalysisResult> {
    const prompt = this.buildAnalysisPrompt(headers, sampleData);
    
    try {
      const aiResponse = await this.callAI(prompt);
      return this.parseAIResponse(aiResponse);
    } catch (error) {
      console.error('AIåˆ†æå¤±è´¥:', error);
      // é™çº§åˆ°åŸºç¡€ç®—æ³•
      return this.fallbackAnalysis(headers, sampleData);
    }
  }

  private buildAnalysisPrompt(headers: string[], sampleData: any[]): string {
    const standardFields = {
      'student_id': 'å­¦å·',
      'name': 'å§“å',
      'class_name': 'ç­çº§',
      'score': 'åˆ†æ•°/æˆç»©',
      'grade': 'ç­‰çº§/è¯„çº§',
      'rank_in_class': 'ç­çº§æ’å',
      'rank_in_grade': 'å¹´çº§æ’å'
    };

    const subjectMapping = {
      'è¯­æ–‡': 'chinese',
      'æ•°å­¦': 'math', 
      'è‹±è¯­': 'english',
      'ç‰©ç†': 'physics',
      'åŒ–å­¦': 'chemistry',
      'ç”Ÿç‰©': 'biology',
      'æ”¿æ²»': 'politics',
      'å†å²': 'history',
      'åœ°ç†': 'geography'
    };

    return `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²æ•°æ®è§£æä¸“å®¶ã€‚è¯·åˆ†æä»¥ä¸‹å­¦ç”Ÿæˆç»©æ•°æ®çš„å­—æ®µç»“æ„ï¼š

è¡¨å¤´å­—æ®µ: ${headers.join(', ')}

æ•°æ®æ ·æœ¬:
${JSON.stringify(sampleData.slice(0, 3), null, 2)}

æ ‡å‡†å­—æ®µå®šä¹‰:
${Object.entries(standardFields).map(([key, desc]) => `- ${key}: ${desc}`).join('\n')}

ç§‘ç›®å¯¹åº”å…³ç³»:
${Object.entries(subjectMapping).map(([chinese, english]) => `- ${chinese} â†’ ${english}`).join('\n')}

è¯·è¿”å›JSONæ ¼å¼åˆ†æç»“æœï¼š
{
  "mappings": [
    {
      "originalField": "åŸå§‹å­—æ®µå",
      "mappedField": "æ ‡å‡†å­—æ®µå",
      "subject": "ç§‘ç›®åç§°(å¦‚æœé€‚ç”¨)",
      "dataType": "score/grade/rank/student_info",
      "confidence": 0.9,
      "notes": "å¤„ç†è¯´æ˜"
    }
  ],
  "subjects": ["è¯†åˆ«åˆ°çš„ç§‘ç›®åˆ—è¡¨"],
  "tableStructure": {
    "type": "wide/long/mixed",
    "hasMergedCells": false,
    "hasMultiLevelHeaders": false
  },
  "examInfo": {
    "title": "æ¨æ–­çš„è€ƒè¯•æ ‡é¢˜",
    "type": "æ¨æ–­çš„è€ƒè¯•ç±»å‹"
  },
  "dataQuality": {
    "missingFields": ["ç¼ºå¤±çš„é‡è¦å­—æ®µ"],
    "inconsistentFormats": ["æ ¼å¼ä¸ä¸€è‡´çš„å­—æ®µ"],
    "suspiciousData": ["å¯ç–‘çš„æ•°æ®é—®é¢˜"]
  },
  "confidence": 0.9,
  "reasoning": "è¯¦ç»†åˆ†ææ¨ç†"
}`;
  }

  private parseAIResponse(aiResponse: string): AIAnalysisResult {
    try {
      // æå–JSONéƒ¨åˆ†
      const jsonMatch = aiResponse.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        const parsed = JSON.parse(jsonMatch[0]);
        return {
          mappings: parsed.mappings || [],
          subjects: parsed.subjects || [],
          tableStructure: parsed.tableStructure || {
            type: 'wide',
            hasMergedCells: false,
            hasMultiLevelHeaders: false
          },
          examInfo: parsed.examInfo || {},
          dataQuality: parsed.dataQuality || {
            missingFields: [],
            inconsistentFormats: [],
            suspiciousData: []
          },
          confidence: parsed.confidence || 0.7,
          reasoning: parsed.reasoning || 'åŸºäºAIåˆ†æ'
        };
      }
    } catch (error) {
      console.error('AIå“åº”è§£æå¤±è´¥:', error);
    }

    // è§£æå¤±è´¥ï¼Œé™çº§å¤„ç†
    throw new Error('AIå“åº”æ ¼å¼ä¸æ­£ç¡®');
  }

  private fallbackAnalysis(headers: string[], sampleData: any[]): AIAnalysisResult {
    // åŸºç¡€è§„åˆ™æ˜ å°„
    const mappings: FieldMapping[] = [];
    const subjects: string[] = [];
    
    headers.forEach(header => {
      const mapping = this.mapFieldBasic(header);
      if (mapping) {
        mappings.push(mapping);
        if (mapping.subject && !subjects.includes(mapping.subject)) {
          subjects.push(mapping.subject);
        }
      }
    });

    return {
      mappings,
      subjects,
      tableStructure: {
        type: 'wide',
        hasMergedCells: false,
        hasMultiLevelHeaders: false
      },
      examInfo: {},
      dataQuality: {
        missingFields: [],
        inconsistentFormats: [],
        suspiciousData: []
      },
      confidence: 0.5,
      reasoning: 'ä½¿ç”¨åŸºç¡€è§„åˆ™åˆ†æï¼ˆAIä¸å¯ç”¨ï¼‰'
    };
  }

  private mapFieldBasic(field: string): FieldMapping | null {
    const fieldLower = field.toLowerCase().trim();
    
    // åŸºç¡€å­—æ®µæ˜ å°„
    if (fieldLower.includes('å­¦å·') || fieldLower.includes('student id')) {
      return {
        originalField: field,
        mappedField: 'student_id',
        dataType: 'student_info',
        confidence: 0.9
      };
    }
    
    if (fieldLower.includes('å§“å') || fieldLower.includes('name')) {
      return {
        originalField: field,
        mappedField: 'name', 
        dataType: 'student_info',
        confidence: 0.9
      };
    }

    // ç§‘ç›®è¯†åˆ«
    const subjects = ['è¯­æ–‡', 'æ•°å­¦', 'è‹±è¯­', 'ç‰©ç†', 'åŒ–å­¦', 'ç”Ÿç‰©', 'æ”¿æ²»', 'å†å²', 'åœ°ç†'];
    for (const subject of subjects) {
      if (field.includes(subject)) {
        return {
          originalField: field,
          mappedField: `${subject}_score`,
          subject: subject,
          dataType: 'score',
          confidence: 0.8
        };
      }
    }

    return null;
  }
}

// å¯¼å‡ºå•ä¾‹
export const aiFieldAnalyzer = new AIFieldAnalyzer();
```

### 2. é›†æˆåˆ°ç°æœ‰è§£æå™¨

```typescript
// ä¿®æ”¹ src/services/intelligentFileParser.ts
import { aiFieldAnalyzer } from './aiFieldAnalyzer';

// åœ¨ performAIAnalysis æ–¹æ³•ä¸­æ›¿æ¢åŸæ¥çš„ Edge Function è°ƒç”¨
private async performAIAnalysis(headers: string[], sampleData: any[]): Promise<{...} | null> {
  try {
    console.log('[AIåˆ†æ] å¼€å§‹å‰ç«¯AIå­—æ®µåˆ†æ...');
    
    const result = await aiFieldAnalyzer.analyzeFields(headers, sampleData);
    
    console.log('[AIåˆ†æ] AIåˆ†ææˆåŠŸ:', result);
    return {
      mappings: result.mappings,
      subjects: result.subjects,
      confidence: result.confidence
    };
  } catch (error) {
    console.error('[AIåˆ†æ] å‰ç«¯AIåˆ†æå¤±è´¥:', error);
    return null;
  }
}
```

## 3. éªŒè¯AIæ˜¯å¦å·¥ä½œçš„æ–¹æ³•

### å‰ç«¯è°ƒè¯•å·¥å…·
```typescript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
import { aiFieldAnalyzer } from '@/services/aiFieldAnalyzer';

const testHeaders = ['å­¦å·', 'å§“å', 'è¯­æ–‡', 'æ•°å­¦'];
const testData = [
  { 'å­¦å·': '2024001', 'å§“å': 'å¼ ä¸‰', 'è¯­æ–‡': '85', 'æ•°å­¦': '92' }
];

aiFieldAnalyzer.analyzeFields(testHeaders, testData)
  .then(result => {
    console.log('AIåˆ†æç»“æœ:', result);
    console.log('ç½®ä¿¡åº¦:', result.confidence);
    console.log('å­—æ®µæ˜ å°„:', result.mappings);
  });
```

### å¯¹æ¯”æµ‹è¯•
```typescript
// å¯¹æ¯”AIåˆ†æ vs åŸºç¡€ç®—æ³•
const compareAnalysis = async (headers, data) => {
  // AIåˆ†æ
  const aiResult = await aiFieldAnalyzer.analyzeFields(headers, data);
  
  // åŸºç¡€ç®—æ³•ï¼ˆå½“å‰çš„fallbackï¼‰
  const basicResult = basicFieldMapper.mapFields(headers);
  
  console.log('AIè¯†åˆ«å­—æ®µæ•°:', aiResult.mappings.length);
  console.log('åŸºç¡€ç®—æ³•è¯†åˆ«å­—æ®µæ•°:', basicResult.length);
  console.log('AIç½®ä¿¡åº¦:', aiResult.confidence);
};
```

## 4. AIä»·å€¼ä½“ç°

### æ™ºèƒ½è¯†åˆ«ç¤ºä¾‹
```
è¾“å…¥å­—æ®µ: ["Student ID", "Full Name", "Math Score", "è¯­æ–‡æˆç»©", "English Grade"]

AIåˆ†æç»“æœ:
- Student ID â†’ student_id (ç½®ä¿¡åº¦: 0.95)
- Full Name â†’ name (ç½®ä¿¡åº¦: 0.92) 
- Math Score â†’ math_score (ç½®ä¿¡åº¦: 0.88, ç§‘ç›®: æ•°å­¦)
- è¯­æ–‡æˆç»© â†’ chinese_score (ç½®ä¿¡åº¦: 0.90, ç§‘ç›®: è¯­æ–‡)
- English Grade â†’ english_grade (ç½®ä¿¡åº¦: 0.85, ç§‘ç›®: è‹±è¯­, ç±»å‹: grade)

åŸºç¡€ç®—æ³•ç»“æœ:
- Student ID â†’ æœªè¯†åˆ«
- Full Name â†’ æœªè¯†åˆ«
- Math Score â†’ æœªè¯†åˆ«
- è¯­æ–‡æˆç»© â†’ chinese_score (ç½®ä¿¡åº¦: 0.8)
- English Grade â†’ æœªè¯†åˆ«
```

è¿™æ ·ä½ å°±èƒ½æ¸…æ¥šçœ‹åˆ°AIçš„ä»·å€¼äº†ï¼ 