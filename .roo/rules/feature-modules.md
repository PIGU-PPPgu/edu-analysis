---
description: 
globs: 
alwaysApply: true
---
# 功能模块详解

> 🎯 **使用场景**: 了解各功能模块的实现状态、开发新功能、模块间关系分析时使用此规则

基于[.doc/功能模块梳理.md](mdc:.doc/功能模块梳理.md)的功能模块分析。

## 🎯 系统功能总览

学生画像系统包含8个核心功能模块，涵盖教学管理的完整流程：从数据导入到分析预警，从作业管理到学生画像生成。

## 📚 已实现功能模块

### 1. 👤 用户认证模块
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/auth/](mdc:src/components/auth)

**核心功能**:
- 🔑 **登录功能**: 邮箱密码登录，支持记住登录状态
- 📝 **注册功能**: 新用户注册，教师身份验证
- 📋 **服务条款**: 用户协议和隐私政策
- 🛡️ **权限管理**: 基于Supabase Auth的教师权限系统

**技术实现**:
```
认证流程: Supabase Auth → JWT Token → 前端状态管理
相关组件: LoginForm, RegisterForm, AuthProvider
数据表: auth.users, user_profiles, teachers
```

### 2. 📊 数据导入模块  
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/db/](mdc:src/components/db)

**核心功能**:
- 👥 **学生信息导入**:
  - 单个添加: 学号、姓名、班级(必填) + 其他信息(选填)
  - 批量导入: Excel/CSV模板批量导入
  - 模板下载: 标准导入模板提供
- 📈 **成绩数据导入**:
  - 单个成绩录入
  - 批量成绩导入
  - 学生列表查看

**数据验证规则**:
```
学生信息: 学号唯一性、姓名格式、班级关联验证
成绩数据: 分数范围验证、科目关联、考试类型匹配
```

### 3. 📝 作业管理模块
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/homework/](mdc:src/components/homework)

**核心功能**:
- 📊 **作业概览**: 总数、待批改数、关联班级数、已截止作业统计
- 📋 **作业列表**: 标题、班级、截止日期、状态管理
- 🚀 **作业发布**: 创建新作业，设置班级和截止时间
- ✅ **作业批改**: 在线批改系统，评分和评语
- ⚙️ **批改设置**: 批改参数和评分标准配置
- 🔍 **筛选搜索**: 按班级、状态、关键词筛选

**数据流程**:
```
作业创建 → 班级分发 → 学生提交 → 教师批改 → 成绩统计 → 分析反馈
```

### 4. 📊 成绩分析模块
> **实现状态**: ✅ 核心功能完成，高级分析在完善  
> **关键文件**: [src/components/analysis/](mdc:src/components/analysis)

**核心功能**:
- 📈 **数据看板**:
  - 考试信息展示: 当前分析考试基本信息
  - 成绩概览: 平均分、最高分、最低分、及格率
  - 分数段分布: 堆叠柱状图、饼图展示
  - 成绩分布: 箱线图统计分析
  - 明细表格: 详细成绩数据展示

- 🎯 **专项分析**:
  - 班级分析: 班级间对比分析
  - 学生进步: 学生成绩趋势分析
  - 高级分析: 多维度数据挖掘
  - 交叉分析: 多科目关联分析
  - 异常检测: 成绩异常识别
  - 相关性分析: 科目间相关性
  - 班级箱线图: 班级成绩分布可视化
  - 贡献度分析: 学生对班级贡献度

**图表库使用**:
```
Recharts: 基础图表 (柱状图、线图、饼图)
Nivo: 高级图表 (箱线图、热力图、雷达图)
Chart.js: 特定需求图表
```

### 5. ⚠️ 预警分析模块
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/warning/](mdc:src/components/warning)

**核心功能**:
- 📊 **预警概览**:
  - 学生总数统计、风险学生数量和占比
  - 高风险学生识别和统计
  - 风险类型统计和分布
  - 风险级别分布展示
  - 影响因素分析图表

- 🎯 **预警管理**:
  - AI智能分析: 基于多模型的预警分析
  - 学生预警列表: 预警信息、类型、级别管理
  - 预警状态管理: 解决、忽略、重新激活
  - 学生筛选: 按姓名、班级、风险等级筛选

- 📋 **规则管理**:
  - 预警规则创建、编辑、删除
  - 规则启用/禁用控制
  - 预设规则模板: 连续不及格、成绩下降、出勤率、综合成绩

**预警类型**:
```
成绩预警: 成绩下降、连续不及格、单科异常
作业预警: 作业拖欠、质量下降
参与度预警: 课堂参与度低、互动减少  
行为预警: 综合行为异常模式
```

### 6. 👤 学生画像模块
> **实现状态**: ✅ 基础功能完成，AI分析在完善  
> **关键文件**: [src/components/portrait/](mdc:src/components/portrait)

**核心功能**:
- 👥 **班级画像**:
  - 班级列表展示: 年级、人数、基本信息
  - 班级信息概览: 成绩分布、学生特征
  - 班级画像生成: AI驱动的班级特征分析

- 🤝 **小组画像**: 学习小组分析和特征描述
- 👤 **学生画像**: 个性化学生特征分析
- 🔍 **智能筛选**: 按班级名称、年级搜索

**AI画像分析维度**:
```
学习能力: 各科目掌握程度、学习速度、理解能力
学习习惯: 作业完成情况、课堂参与度、学习规律
个性特征: 学习风格、兴趣偏好、社交特征
发展潜力: 成长趋势、优势学科、改进空间
```

### 7. 👥 班级管理模块
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/class/](mdc:src/components/class)

**核心功能**:
- 📊 **班级概览**: 关键指标展示(平均分、优秀率、及格率)
- ➕ **班级创建**: 新班级添加，年级、班级名称设置
- 🔍 **班级筛选**: 按名称、年级进行筛选查找
- 📈 **班级排序**: 按平均分、人数、优秀率等条件排序
- 👥 **学生管理**: 班级学生列表、信息管理

**班级数据统计**:
```
基础统计: 人数、男女比例、平均年龄
成绩统计: 平均分、最高分、最低分、标准差
率类统计: 及格率、优秀率、良好率
排名信息: 年级排名、历史对比
```

### 8. 🤖 AI设置模块
> **实现状态**: ✅ 已完成  
> **关键文件**: [src/components/settings/](mdc:src/components/settings)

**核心功能**:
- 🔧 **AI模型配置**:
  - 提供商选择: OpenAI、豆包视觉、DeepSeek等
  - API密钥配置和连接测试
  - 模型选择和参数调优

- 📊 **分析范围设置**:
  - 基础分析: 成绩趋势、学科优势、基础能力、学习习惯
  - 深度分析: 学习风格、个性化建议、潜力预测、综合能力

**支持的AI模型**:
```
OpenAI系列: GPT-4, GPT-3.5-turbo
豆包(火山方舟): 通用模型、教育专用模型  
DeepSeek: 开源模型
百川大模型: 中文优化模型
通义千问: 阿里云AI服务
其他模型: 可扩展集成
```

## 🔄 模块间关系图

### 数据依赖关系
```
数据导入 ─────┐
              ├─→ 成绩分析 ─────┐
班级管理 ─────┘                ├─→ 预警分析 ──→ 学生画像
                              │
作业管理 ─────────────────────┘
              │
              └─→ AI设置 ─────────────────→ 所有AI功能
```

### 功能交互关系
```
用户认证 → 权限控制 → 所有功能模块访问
数据导入 → 基础数据 → 所有分析功能
成绩分析 ↔ 预警分析 ↔ 学生画像 (相互引用)
班级管理 ↔ 作业管理 (班级信息共享)
AI设置 → 影响所有AI相关功能的行为
```

## 🚧 开发状态总结

### ✅ 已充分实现
- 用户认证系统(登录、注册、权限)
- 基础数据导入功能(学生、成绩)
- 作业管理基本功能(发布、批改、统计)
- 成绩数据展示和基础分析
- 预警规则管理和基础预警
- 班级管理基本功能
- AI服务配置和API集成

### 🔄 正在完善
- 成绩分析的高级算法和深度挖掘
- 学生画像的AI个性化分析
- 预警分析的智能化程度
- 作业系统的高级功能

### 📝 开发注意事项

1. **模块间通信**: 使用React Context和React Query管理跨模块状态
2. **数据一致性**: 确保各模块间数据同步和一致性
3. **AI服务**: 所有AI功能统一通过Edge Functions代理
4. **权限控制**: 各功能模块都需要验证用户权限
5. **错误处理**: 统一的错误处理和用户提示机制

### 🔗 相关规则文件
- [project-architecture.md](mdc:project-architecture.md) - 技术架构详解
- [ui-components.md](mdc:ui-components.md) - UI组件规范
- [database-operations.md](mdc:database-operations.md) - 数据库操作
- [ai-support.md](mdc:ai-support.md) - AI开发支持

参考[main-guide.md](mdc:main-guide.md)获取完整导航信息。
