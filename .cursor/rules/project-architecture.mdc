---
description: äº†è§£é¡¹ç›®æ•´ä½“æ¶æ„ã€ç›®å½•ç»“æ„ã€æŠ€æœ¯æ ˆé€‰å‹ã€æ•°æ®æµè®¾è®¡æ—¶ä½¿ç”¨æ­¤è§„åˆ™
globs: 
alwaysApply: false
---
# é¡¹ç›®æ¶æ„è¯¦è§£

> ğŸ¯ **ä½¿ç”¨åœºæ™¯**: äº†è§£é¡¹ç›®æ•´ä½“æ¶æ„ã€ç›®å½•ç»“æ„ã€æŠ€æœ¯æ ˆé€‰å‹ã€æ•°æ®æµè®¾è®¡æ—¶ä½¿ç”¨æ­¤è§„åˆ™

åŸºäº[.doc/é¡¹ç›®ç»“æ„åˆ†æ.md](mdc:.doc/é¡¹ç›®ç»“æ„åˆ†æ.md)çš„è¯¦ç»†æ¶æ„åˆ†æã€‚

## ğŸ—ï¸ æŠ€æœ¯æ ˆè¯¦è§£

### å‰ç«¯æŠ€æœ¯æ ˆ
```
æ ¸å¿ƒæ¡†æ¶:
â”œâ”€â”€ React 18 - ç”¨æˆ·ç•Œé¢åº“
â”œâ”€â”€ TypeScript - ç±»å‹å®‰å…¨
â”œâ”€â”€ Vite - æ„å»ºå·¥å…·
â””â”€â”€ Next.js - éƒ¨åˆ†é¡µé¢ä½¿ç”¨

çŠ¶æ€ç®¡ç†:
â”œâ”€â”€ React Query - æœåŠ¡å™¨çŠ¶æ€ç®¡ç†
â”œâ”€â”€ React Context - å…¨å±€çŠ¶æ€å…±äº«
â””â”€â”€ React Hook Form - è¡¨å•çŠ¶æ€

UI & æ ·å¼:
â”œâ”€â”€ Shadcn UI (åŸºäºRadix UI) - ç»„ä»¶åº“
â”œâ”€â”€ Tailwind CSS - æ ·å¼æ¡†æ¶
â”œâ”€â”€ Material UI - éƒ¨åˆ†ç»„ä»¶
â””â”€â”€ Ant Design - ç‰¹å®šåœºæ™¯ç»„ä»¶

æ•°æ®å¯è§†åŒ–:
â”œâ”€â”€ Recharts - ä¸»è¦å›¾è¡¨åº“
â”œâ”€â”€ Nivo (@nivo/bar, @nivo/line) - é«˜çº§å›¾è¡¨
â””â”€â”€ Chart.js - ç‰¹å®šå›¾è¡¨éœ€æ±‚

å·¥å…·åº“:
â”œâ”€â”€ Lodash - å·¥å…·å‡½æ•°
â”œâ”€â”€ date-fns - æ—¥æœŸå¤„ç†
â”œâ”€â”€ Zod - æ•°æ®éªŒè¯
â””â”€â”€ React Router - è·¯ç”±ç®¡ç†
```

### åç«¯æŠ€æœ¯æ ˆ
```
Supabase ç”Ÿæ€:
â”œâ”€â”€ PostgreSQL - æ•°æ®åº“
â”œâ”€â”€ Supabase Auth - ç”¨æˆ·è®¤è¯
â”œâ”€â”€ Edge Functions - æœåŠ¡ç«¯é€»è¾‘
â”œâ”€â”€ Real-time - å®æ—¶æ•°æ®åŒæ­¥
â””â”€â”€ Storage - æ–‡ä»¶å­˜å‚¨

AIæœåŠ¡é›†æˆ:
â”œâ”€â”€ OpenAI API - ä¸»è¦AIæœåŠ¡
â”œâ”€â”€ è±†åŒ…(ç«å±±æ–¹èˆŸ) - å›½äº§AIæ¨¡å‹
â”œâ”€â”€ DeepSeek - å¼€æºæ¨¡å‹
â”œâ”€â”€ ç™¾å·å¤§æ¨¡å‹ - å‚ç›´é¢†åŸŸæ¨¡å‹
â””â”€â”€ é€šä¹‰åƒé—® - é˜¿é‡Œäº‘AIæœåŠ¡
```

## ğŸ“ ç›®å½•ç»“æ„è¯¦è§£

### æ ¹ç›®å½•ç»“æ„
```
figma-frame-faithful-front/
â”œâ”€â”€ .doc/              # ğŸ“š é¡¹ç›®æ–‡æ¡£å’Œåˆ†ææŠ¥å‘Š
â”œâ”€â”€ docs/              # ğŸ“– ç”¨æˆ·æ–‡æ¡£
â”œâ”€â”€ public/            # ğŸŒ é™æ€èµ„æº
â”‚   â””â”€â”€ api/           # APIç›¸å…³é™æ€æ–‡ä»¶
â”œâ”€â”€ server/            # ğŸ–¥ï¸ æœ¬åœ°æœåŠ¡å™¨ä»£ç 
â”œâ”€â”€ services/          # ğŸ”§ æœåŠ¡å±‚ä»£ç 
â”œâ”€â”€ src/               # ğŸ’» å‰ç«¯æºä»£ç  (æ ¸å¿ƒ)
â”œâ”€â”€ storage/           # ğŸ’¾ æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ homework_files/   # ä½œä¸šæ–‡ä»¶
â”‚   â””â”€â”€ homework_images/  # ä½œä¸šå›¾ç‰‡
â”œâ”€â”€ supabase/          # ğŸ—„ï¸ Supabaseåç«¯é…ç½®
â”œâ”€â”€ tools/             # ğŸ› ï¸ å¼€å‘å·¥å…·
â””â”€â”€ [é…ç½®æ–‡ä»¶...]      # âš™ï¸ å„ç§é…ç½®æ–‡ä»¶
```

### å‰ç«¯æºç  (src/) è¯¦ç»†ç»“æ„
```
src/
â”œâ”€â”€ app/                    # ğŸ¯ åº”ç”¨çº§ä»£ç 
â”‚   â”œâ”€â”€ components/         # åº”ç”¨çº§ç»„ä»¶
â”‚   â”‚   â””â”€â”€ class/         # ç­çº§ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ db/                # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â””â”€â”€ migrations/    # æ•°æ®è¿ç§»è„šæœ¬
â”‚   â””â”€â”€ teacher/           # æ•™å¸ˆåŠŸèƒ½æ¨¡å—
â”‚       â””â”€â”€ homework/      # æ•™å¸ˆä½œä¸šç®¡ç†
â”‚
â”œâ”€â”€ components/            # ğŸ§© å¯é‡ç”¨ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ analysis/          # ğŸ“Š æ•°æ®åˆ†æç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ student/       # å­¦ç”Ÿåˆ†æ
â”‚   â”‚   â”œâ”€â”€ subject/       # å­¦ç§‘åˆ†æ
â”‚   â”‚   â””â”€â”€ utils/         # åˆ†æå·¥å…·
â”‚   â”œâ”€â”€ assignment/        # ğŸ“ ä½œä¸šç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ auth/              # ğŸ” è®¤è¯ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ class/             # ğŸ‘¥ ç­çº§ç®¡ç†ç»„ä»¶
â”‚   â”œâ”€â”€ db/                # ğŸ—ƒï¸ æ•°æ®åº“æ“ä½œç»„ä»¶
â”‚   â”œâ”€â”€ home/              # ğŸ  ä¸»é¡µç»„ä»¶
â”‚   â”œâ”€â”€ homework/          # ğŸ“š ä½œä¸šç®¡ç†ç»„ä»¶
â”‚   â”œâ”€â”€ landing/           # ğŸš€ ç™»å½•é¡µç»„ä»¶
â”‚   â”œâ”€â”€ onboarding/        # ğŸ¯ å¼•å¯¼æµç¨‹ç»„ä»¶
â”‚   â”œâ”€â”€ portrait/          # ğŸ‘¤ å­¦ç”Ÿç”»åƒç»„ä»¶
â”‚   â”œâ”€â”€ profile/           # âš™ï¸ ç”¨æˆ·é…ç½®ç»„ä»¶
â”‚   â”œâ”€â”€ settings/          # ğŸ› ï¸ è®¾ç½®ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ shared/            # ğŸ”„ å…±äº«ç»„ä»¶
â”‚   â”œâ”€â”€ test/              # ğŸ§ª æµ‹è¯•ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                # ğŸ¨ åŸºç¡€UIç»„ä»¶
â”‚   â””â”€â”€ warning/           # âš ï¸ é¢„è­¦åˆ†æç»„ä»¶
â”‚
â”œâ”€â”€ config/                # âš™ï¸ åº”ç”¨é…ç½®
â”œâ”€â”€ constants/             # ğŸ“‹ å¸¸é‡å®šä¹‰
â”œâ”€â”€ contexts/              # ğŸ”„ Reactä¸Šä¸‹æ–‡
â”œâ”€â”€ data/                  # ğŸ“Š é™æ€æ•°æ®
â”œâ”€â”€ hooks/                 # ğŸ£ è‡ªå®šä¹‰é’©å­
â”œâ”€â”€ integrations/          # ğŸ”Œ å¤–éƒ¨é›†æˆ
â”‚   â””â”€â”€ supabase/          # Supabaseå®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ lib/                   # ğŸ“š å·¥å…·åº“
â”‚   â””â”€â”€ api/               # APIç›¸å…³å·¥å…·
â”œâ”€â”€ migrations/            # ğŸ”„ æ•°æ®åº“è¿ç§»
â”œâ”€â”€ pages/                 # ğŸ“„ é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ api/               # APIè·¯ç”±
â”‚   â”œâ”€â”€ settings/          # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ test/              # æµ‹è¯•é¡µé¢
â”‚   â””â”€â”€ tools/             # å·¥å…·é¡µé¢
â”œâ”€â”€ services/              # ğŸ”§ æœåŠ¡å±‚
â”‚   â””â”€â”€ __tests__/         # æœåŠ¡æµ‹è¯•
â”œâ”€â”€ sql/                   # ğŸ“ SQLæŸ¥è¯¢æ–‡ä»¶
â”œâ”€â”€ tools/                 # ğŸ› ï¸ å·¥å…·è„šæœ¬
â”œâ”€â”€ types/                 # ğŸ“‹ TypeScriptç±»å‹å®šä¹‰
â””â”€â”€ utils/                 # ğŸ”§ å·¥å…·å‡½æ•°
```

### Supabaseåç«¯ç»“æ„
```
supabase/
â”œâ”€â”€ functions/             # â˜ï¸ Edge Functions
â”‚   â”œâ”€â”€ _shared/           # å…±äº«ä»£ç å’Œå·¥å…·
â”‚   â”œâ”€â”€ ai-file-analysis/  # ğŸ“Š AIæ–‡ä»¶åˆ†ææœåŠ¡
â”‚   â”œâ”€â”€ analyze-data/      # ğŸ“ˆ æ•°æ®åˆ†ææœåŠ¡
â”‚   â”œâ”€â”€ analyze-grades/    # ğŸ¯ æˆç»©åˆ†ææœåŠ¡
â”‚   â”œâ”€â”€ auto-analyze-data/ # ğŸ¤– è‡ªåŠ¨æ•°æ®åˆ†æ
â”‚   â”œâ”€â”€ generate-student-learning-profile/ # ğŸ‘¤ å­¦ä¹ ç”»åƒç”Ÿæˆ
â”‚   â”œâ”€â”€ generate-student-profile/ # ğŸ“ å­¦ç”Ÿç”»åƒç”Ÿæˆ
â”‚   â”œâ”€â”€ get-class-boxplot-data/ # ğŸ“Š ç­çº§ç®±çº¿å›¾æ•°æ®
â”‚   â”œâ”€â”€ get-student-subject-contribution-data/ # ğŸ“ˆ å­¦ç§‘è´¡çŒ®åº¦
â”‚   â”œâ”€â”€ proxy-ai-request/  # ğŸ”„ AIè¯·æ±‚ä»£ç†
â”‚   â”œâ”€â”€ recommend-charts/  # ğŸ“Š å›¾è¡¨æ¨è
â”‚   â”œâ”€â”€ save-exam-data/    # ğŸ’¾ è€ƒè¯•æ•°æ®ä¿å­˜
â”‚   â”œâ”€â”€ sync-notion-data/  # ğŸ”„ Notionæ•°æ®åŒæ­¥
â”‚   â””â”€â”€ validate-api-key/  # ğŸ”‘ APIå¯†é’¥éªŒè¯
â”œâ”€â”€ migrations/            # ğŸ“ˆ æ•°æ®åº“è¿ç§»æ–‡ä»¶
â””â”€â”€ .temp/                # ğŸ—‚ï¸ ä¸´æ—¶æ–‡ä»¶
```

## ğŸ”„ æ•°æ®æµæ¶æ„

### ä¸»è¦æ•°æ®æµå‘
```
1. ç”¨æˆ·äº¤äº’å±‚ (Reactç»„ä»¶)
    â†“ è§¦å‘æ“ä½œ
2. æœåŠ¡å±‚ (services/)
    â†“ è°ƒç”¨API
3. Supabaseå®¢æˆ·ç«¯ (integrations/supabase/)
    â†“ æ•°æ®åº“æ“ä½œ / Edge Functionè°ƒç”¨
4. Supabaseåç«¯
    â†“ æ•°æ®å¤„ç† / AIåˆ†æ
5. æ•°æ®è¿”å›åˆ°å‰ç«¯
    â†“ çŠ¶æ€æ›´æ–°
6. UIé‡æ–°æ¸²æŸ“
```

### AIåˆ†ææ•°æ®æµ
```
å‰ç«¯æ•°æ® â†’ Edge Function (ä»£ç†) â†’ AIæœåŠ¡ â†’ ç»“æœå¤„ç† â†’ æ•°æ®åº“å­˜å‚¨ â†’ å‰ç«¯å±•ç¤º
```

## ğŸ¯ å…³é”®æ¶æ„å†³ç­–

### ä¸ºä»€ä¹ˆé€‰æ‹©è¿™äº›æŠ€æœ¯ï¼Ÿ

**React + TypeScript**:
- âœ… ç»„ä»¶åŒ–å¼€å‘ï¼Œä¾¿äºç»´æŠ¤
- âœ… ç±»å‹å®‰å…¨ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
- âœ… ç”Ÿæ€ä¸°å¯Œï¼Œç¤¾åŒºæ”¯æŒå¥½

**Supabase**:
- âœ… é™ä½åç«¯å¼€å‘å¤æ‚åº¦
- âœ… å†…ç½®è®¤è¯å’Œå®æ—¶åŠŸèƒ½
- âœ… PostgreSQLå…¼å®¹ï¼ŒSQLçµæ´»æ€§
- âœ… Edge Functionsæ”¯æŒå¤æ‚ä¸šåŠ¡é€»è¾‘

**Shadcn UI + Tailwind**:
- âœ… ç°ä»£åŒ–è®¾è®¡é£æ ¼
- âœ… ç»„ä»¶å¯å®šåˆ¶æ€§å¼º
- âœ… å¼€å‘æ•ˆç‡é«˜
- âœ… å“åº”å¼è®¾è®¡å‹å¥½

**React Query**:
- âœ… æœåŠ¡å™¨çŠ¶æ€ç®¡ç†ä¸“ä¸šåŒ–
- âœ… ç¼“å­˜å’ŒåŒæ­¥æœºåˆ¶å®Œå–„
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## ğŸ“Š æ ¸å¿ƒæ•°æ®æ¨¡å‹

### ä¸»è¦æ•°æ®è¡¨ç»“æ„
```
ç”¨æˆ·ç›¸å…³:
â”œâ”€â”€ user_profiles     # ç”¨æˆ·é…ç½®ä¿¡æ¯
â”œâ”€â”€ teachers         # æ•™å¸ˆä¿¡æ¯
â””â”€â”€ auth.users       # Supabaseè®¤è¯è¡¨

æ•™å­¦ç®¡ç†:
â”œâ”€â”€ students         # å­¦ç”Ÿä¿¡æ¯
â”œâ”€â”€ class_info       # ç­çº§ä¿¡æ¯  
â”œâ”€â”€ subjects         # ç§‘ç›®ä¿¡æ¯
â””â”€â”€ academic_terms   # å­¦å¹´å­¦æœŸ

æˆç»©æ•°æ®:
â”œâ”€â”€ grades           # å­¦ç”Ÿæˆç»©
â”œâ”€â”€ exam_types       # è€ƒè¯•ç±»å‹
â””â”€â”€ grade_data       # æˆç»©æ˜ç»†

ä½œä¸šç³»ç»Ÿ:
â”œâ”€â”€ homework         # ä½œä¸šä¿¡æ¯
â”œâ”€â”€ homework_submissions # ä½œä¸šæäº¤
â””â”€â”€ homework_files   # ä½œä¸šæ–‡ä»¶

åˆ†æé¢„è­¦:
â”œâ”€â”€ student_warnings # å­¦ç”Ÿé¢„è­¦
â”œâ”€â”€ warning_rules    # é¢„è­¦è§„åˆ™
â””â”€â”€ analysis_results # åˆ†æç»“æœ
```

## ğŸ”Œ ç³»ç»Ÿé›†æˆç‚¹

### ä¸»è¦é›†æˆæ¥å£
1. **AIæœåŠ¡é›†æˆ** - [supabase/functions/proxy-ai-request/](mdc:supabase/functions/proxy-ai-request)
2. **æ–‡ä»¶ä¸Šä¼ ** - Supabase Storage
3. **å®æ—¶é€šä¿¡** - Supabase Realtime
4. **è®¤è¯æœåŠ¡** - Supabase Auth

### å…³é”®é…ç½®æ–‡ä»¶
- [src/integrations/supabase/client.ts](mdc:src/integrations/supabase/client.ts) - Supabaseå®¢æˆ·ç«¯é…ç½®
- [vite.config.ts](mdc:vite.config.ts) - Viteæ„å»ºé…ç½®
- [tailwind.config.ts](mdc:tailwind.config.ts) - Tailwindæ ·å¼é…ç½®
- [database-schema.sql](mdc:database-schema.sql) - æ•°æ®åº“ç»“æ„å®šä¹‰

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

1. **ä»£ç åˆ†å‰²**: ä½¿ç”¨React.lazyè¿›è¡Œè·¯ç”±çº§åˆ«åˆ†å‰²
2. **çŠ¶æ€ç¼“å­˜**: React Queryç¼“å­˜æœåŠ¡å™¨æ•°æ®
3. **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨Supabase Storageçš„å›¾ç‰‡è½¬æ¢
4. **æ„å»ºä¼˜åŒ–**: Viteçš„å¿«é€ŸHMRå’Œä¼˜åŒ–æ‰“åŒ…
5. **æ•°æ®åº“ä¼˜åŒ–**: åˆç†çš„ç´¢å¼•å’ŒæŸ¥è¯¢ä¼˜åŒ–

å‚è€ƒ[main-guide.mdc](mdc:main-guide.mdc)è·å–æ›´å¤šå¯¼èˆªä¿¡æ¯ã€‚
